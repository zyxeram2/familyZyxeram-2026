<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Family Cinema 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ú®</text></svg>">
</head>
<body>

    <canvas id="bgCanvas"></canvas>
    <div class="noise-overlay"></div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="nav-bar hidden" id="navBar">
        <button class="nav-icon-btn" id="navHomeBtn" aria-label="–í –Ω–∞—á–∞–ª–æ">
            <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
        </button>
        <div class="nav-links-wrapper">
            <div class="nav-links">
                <button data-target="scene-intro">–ö–∏–Ω–æ–∑–∞–ª</button>
                <button data-target="scene-album">–•—Ä–æ–Ω–∏–∫–∞</button>
                <button data-target="scene-tree">–Å–ª–∫–∞</button>
                <button data-target="scene-fortune">–û—Ä–∞–∫—É–ª</button>
                <button data-target="scene-interview">–ò–Ω—Ç–µ—Ä–≤—å—é</button>
                <button data-target="scene-gallery">–ì–∞–ª–µ—Ä–µ—è</button> <!-- NEW -->
                <button data-target="scene-capsule">–ö–∞–ø—Å—É–ª–∞</button>
            </div>
        </div>
        <button class="nav-icon-btn" id="soundToggle" aria-label="–ó–≤—É–∫">üîá</button>
    </nav>

    <!-- –°–¶–ï–ù–ê 0: –ü–æ—Å—Ç–µ—Ä -->
    <section id="scene-start" class="scene active">
        <div class="hero-content">
            <div class="hero-label">–°–µ–º–µ–π–Ω–∞—è –ø—Ä–µ–º—å–µ—Ä–∞</div>
            <h1 class="hero-title">–°–ï–ú–¨–Ø <span class="year-accent">2026</span></h1>
            <p class="hero-subtitle">–ò—Å—Ç–æ—Ä–∏—è, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–∏—à–µ–º –≤–º–µ—Å—Ç–µ</p>
            <div class="hero-meta">
                <div class="meta-item"><span>–†–µ–∂–∏—Å—Å–µ—Ä</span><br>–í—Ä–µ–º—è</div>
                <div class="meta-divider"></div>
                <div class="meta-item"><span>–í —Ä–æ–ª—è—Ö</span><br>–ú—ã –≤—Å–µ</div>
            </div>
            <button class="play-btn" id="startBtn"><span class="play-icon">‚ñ∂</span> –°–º–æ—Ç—Ä–µ—Ç—å —Ñ–∏–ª—å–º</button>
        </div>
    </section>

    <!-- –°–¶–ï–ù–ê 1: –¢–∏—Ç—Ä—ã -->
    <section id="scene-intro" class="scene">
        <button class="skip-btn" id="skipIntroBtn">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
        <div class="credits-viewport">
            <div id="creditsContainer" class="credits-container"></div>
        </div>
    </section>

    <!-- –®—Ç–æ—Ä–∫–∞ -->
    <div id="curtain" class="curtain">
        <div class="curtain-content">
            <h2 id="curtainTitle">Chapter 1</h2>
            <div class="loader-line"></div>
        </div>
    </div>

    <!-- –°–¶–ï–ù–ê 2: –ê–ª—å–±–æ–º -->
    <section id="scene-album" class="scene scroll-scene">
        <header class="scene-header">
            <span class="scene-number">–ì–ª–∞–≤–∞ I</span>
            <h2>–•—Ä–æ–Ω–∏–∫–∏ –ì–æ–¥–∞</h2>
        </header>
        <div class="timeline-container" id="albumTimeline">
            <div class="timeline-line"></div>
        </div>
        <button class="ghost-btn next-scene-btn" data-next="scene-tree">–î–∞–ª–µ–µ: –Å–ª–∫–∞ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π ‚Üì</button>
    </section>

    <!-- –°–¶–ï–ù–ê 3: –Å–ª–∫–∞ -->
    <section id="scene-tree" class="scene">
        <header class="scene-header">
            <span class="scene-number">–ì–ª–∞–≤–∞ II</span>
            <h2>–î–µ—Ä–µ–≤–æ –°–µ–∫—Ä–µ—Ç–æ–≤</h2>
        </header>
        <div class="tree-wrapper">
            <div class="tree-glow"></div>
            <div class="tree-graphic">
                <svg viewBox="0 0 400 600" class="svg-tree">
                    <defs>
                        <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                            <feGaussianBlur stdDeviation="5" result="blur" />
                            <feComposite in="SourceGraphic" in2="blur" operator="over" />
                        </filter>
                    </defs>
                    <path d="M200,40 L40,500 L360,500 Z" fill="rgba(20, 50, 30, 0.4)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />
                    <path d="M200,40 L80,350 L320,350 Z" fill="rgba(30, 70, 40, 0.4)" />
                    <path d="M200,40 L120,200 L280,200 Z" fill="rgba(40, 90, 50, 0.4)" />
                    <path d="M140,150 Q200,220 260,150" fill="none" stroke="rgba(212,175,55,0.3)" stroke-width="2" />
                    <path d="M100,280 Q200,360 300,280" fill="none" stroke="rgba(212,175,55,0.3)" stroke-width="2" />
                    <path d="M60,420 Q200,500 340,420" fill="none" stroke="rgba(212,175,55,0.3)" stroke-width="2" />
                </svg>
                <div id="ornamentsLayer" class="ornaments-layer"></div>
            </div>
        </div>
        <button class="ghost-btn next-scene-btn" data-next="scene-fortune">–î–∞–ª–µ–µ: –û—Ä–∞–∫—É–ª ‚Üì</button>
    </section>

    <!-- –°–¶–ï–ù–ê 4: –û—Ä–∞–∫—É–ª -->
    <section id="scene-fortune" class="scene">
        <header class="scene-header">
            <span class="scene-number">–ì–ª–∞–≤–∞ III</span>
            <h2>–û—Ä–∞–∫—É–ª –°—É–¥—å–±—ã</h2>
        </header>
        <div class="fortune-interface">
            <div class="persona-selector-wrapper">
                <span class="selector-label">–ö–æ–º—É –≥–∞–¥–∞–µ–º?</span>
                <select id="fortunePersona" class="glass-select"></select>
            </div>
            <div class="cards-grid" id="cardsTable"></div>
            <div id="predictionResult" class="prediction-modal hidden">
                <div class="prediction-content">
                    <div class="star-icon">‚ú®</div>
                    <h3 id="predTitle"></h3>
                    <p id="predText"></p>
                    <button class="outline-btn" id="resetFortuneBtn">–¢—è–Ω—É—Ç—å –µ—â—ë</button>
                </div>
            </div>
        </div>
        <button class="ghost-btn next-scene-btn" data-next="scene-interview">–î–∞–ª–µ–µ: –ò–Ω—Ç–µ—Ä–≤—å—é ‚Üì</button>
    </section>

    <!-- –°–¶–ï–ù–ê 5: –ò–Ω—Ç–µ—Ä–≤—å—é -->
    <section id="scene-interview" class="scene">
        <header class="scene-header">
            <span class="scene-number">–ì–ª–∞–≤–∞ IV</span>
            <h2>–ò–Ω—Ç–µ—Ä–≤—å—é 2025</h2>
            <p class="scene-desc">–°–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏</p>
        </header>
        <div class="interview-grid" id="interviewGrid"></div>
        <button class="ghost-btn next-scene-btn" data-next="scene-gallery">–î–∞–ª–µ–µ: –ì–∞–ª–µ—Ä–µ—è ‚Üì</button>
    </section>

    <!-- –°–¶–ï–ù–ê 6: –ì–∞–ª–µ—Ä–µ—è (–ù–û–í–ê–Ø) -->
    <section id="scene-gallery" class="scene full-height-scene">
        <div class="gallery-bg-glow"></div>
        <header class="scene-header gallery-header">
            <span class="scene-number">–ì–ª–∞–≤–∞ V</span>
            <h2>–ù–∞—à–∞ –ì–∞–ª–µ—Ä–µ—è</h2>
        </header>
        
        <div class="gallery-viewport">
            <div class="gallery-track" id="galleryTrack">
                <!-- –°–ª–∞–π–¥—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JS -->
            </div>
            <div class="gallery-controls">
                <button class="gallery-nav prev" id="galleryPrev">‚Üê</button>
                <button class="gallery-nav next" id="galleryNext">‚Üí</button>
            </div>
        </div>

        <button class="ghost-btn next-scene-btn" data-next="scene-capsule" style="margin-top: 20px;">–§–∏–Ω–∞–ª: –ö–∞–ø—Å—É–ª–∞ ‚Üì</button>
    </section>

    <!-- –°–¶–ï–ù–ê 7: –ö–∞–ø—Å—É–ª–∞ -->
    <section id="scene-capsule" class="scene">
        <header class="scene-header">
            <span class="scene-number">–§–∏–Ω–∞–ª</span>
            <h2>–ö–∞–ø—Å—É–ª–∞ –í—Ä–µ–º–µ–Ω–∏</h2>
        </header>
        <div class="capsule-visual">
            <div class="capsule-glass">
                
                <!-- 1. –ó–ê–ö–†–´–¢–û–ï –°–û–°–¢–û–Ø–ù–ò–ï (–¢–∞–π–º–µ—Ä) -->
                <div id="capsuleLocked" class="capsule-content-locked">
                    <div class="timer-wrapper">
                        <div class="timer-unit"><span id="days">00</span><label>–î–Ω–µ–π</label></div>
                        <div class="timer-sep">:</div>
                        <div class="timer-unit"><span id="hours">00</span><label>–ß–∞—Å–æ–≤</label></div>
                        <div class="timer-sep">:</div>
                        <div class="timer-unit"><span id="minutes">00</span><label>–ú–∏–Ω</label></div>
                        <div class="timer-sep">:</div>
                        <div class="timer-unit"><span id="seconds">00</span><label>–°–µ–∫</label></div>
                    </div>
                    <div class="unlock-date">–î–æ—Å—Ç—É–ø–Ω–æ —Å 1 —è–Ω–≤–∞—Ä—è 2026, 00:01 –ú–°–ö</div>
                    <div class="seal-status">
                        <div class="wax-seal">SECRET</div>
                    </div>
                </div>

                <!-- 2. –û–¢–ö–†–´–¢–û–ï –°–û–°–¢–û–Ø–ù–ò–ï (–í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞) -->
                <div id="capsuleUnlocked" class="capsule-content-unlocked hidden">
                    
                    <!-- –§–∞–∑–∞ 1: –°–µ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ -->
                    <div id="recipientSelector" class="capsule-phase">
                        <div class="confetti-burst">üéâ</div>
                        <h3>–ö–∞–ø—Å—É–ª–∞ –û—Ç–∫—Ä—ã—Ç–∞!</h3>
                        <p class="capsule-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ, —á—å—ë –ø–æ—Å–ª–∞–Ω–∏–µ –ø—Ä–æ—á–∏—Ç–∞—Ç—å:</p>
                        
                        <div class="recipients-grid" id="recipientsGrid">
                            <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JS -->
                        </div>
                    </div>

                    <!-- –§–∞–∑–∞ 2: –ß—Ç–µ–Ω–∏–µ –ø–∏—Å—å–º–∞ -->
                    <div id="letterReader" class="capsule-phase hidden">
                        <div class="reader-header">
                            <button class="back-link" id="backToSelectorBtn">‚Üê –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É</button>
                        </div>
                        <div class="letter-paper-container">
                            <div class="letter-paper" id="letterContent">
                                <!-- –¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞ -->
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <!-- –ú–æ–¥–∞–ª–∫–∞ -->
    <div id="modalOverlay" class="modal-overlay hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-window">
            <button class="close-modal">‚úï</button>
            <div class="modal-content" id="modalBody"></div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        (function() {
            const authToken = localStorage.getItem('authToken');
            const authTime = localStorage.getItem('authTime');
            
            if (!authToken || !authTime) {
                window.location.replace('login.html');
                return;
            }
            
            const timeDiff = Date.now() - parseInt(authTime);
            if (timeDiff >= 24 * 60 * 60 * 1000) {
                localStorage.removeItem('authToken');
                localStorage.removeItem('authTime');
                window.location.replace('login.html');
                return;
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º cookie –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
            document.cookie = `authToken=${authToken}; path=/; max-age=86400; SameSite=Lax`;
        })();
    </script>
    <script src="data.js"></script>
    <script src="box.js"></script>
    <script src="app.js"></script>

    <!-- –ú–æ–¥–∞–ª–∫–∞ -->
    <div id="modalOverlay" class="modal-overlay hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-window">
            <button class="close-modal">&times;</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>
